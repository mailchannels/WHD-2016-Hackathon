<?php

/**
 * Receives and processes input.
 *
 * @author  Constantin Romankiewicz <constantin@zweiiconkram.de>
 * @since   1.0
 */
class Modules_Harvard_Receiver
{
    /**
     * Processes data from a JSON file generated by Mailchannels.
     * Deals with reportedly spamming email accounts.
     *
     * @param   array  $data  The decoded data.
     *
     * @return void
     */
    public function processJson($data)
    {
        var_dump($data);
        if (isset($data['envelope_sender']))
        {
            $sender = $data['envelope_sender'];

            if (preg_match('/(.*)\@(.*)/i', $data['envelope_sender'], $matches))
            {
                $username = $matches[1];
                $domain   = $matches[2];

                $mailSettings = new Modules_Harvard_MailSettings;

                // TODO: Check for relevant settings.
                $mailSettings->disableMailDomain($domain);
                //$mailSettings->disableMailUser($domain, $username);
            }
        }
    }
}
